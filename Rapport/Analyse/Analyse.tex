\documentclass[Rapport/Rapport_main.tex]{subfiles}
\begin{document}
\section{Analyse}\label{sec:Rapport_Analyse}
%Her beskrives analysearbejdet, dvs. de overvejelser om mulige løsninger I har haft, de løsninger I har valgt og begrundelsen herfor. De grundlæggende valg af hardware- og softwaremæssige komponenter, som er kritiske for realisering af systemet, beskrives her. For at træffe et valg kan der analyseres og diskuteres forskellige løsninger mht. til ydeevne, pris, leveringstid og forhåndskendskab. Disse kan med fordel opstilles i tabelform. Herefter kan der træffes valg, som danner et ”proof of concept” for de forskellige dele af projektet. Der skal selvfølgelig argumenteres for disse valg. Der kan med fordel refereres til detaljer i dokumentet ”Analyse” i projektets bilag.
I dette afsnit beskrives det analyse arbejde, hvor de forskellige overvejelser omkring løsninger kommer til udtryk. Der vil hertil lave en begrundelse for de grundlæggende valg af komponenter i systemet. \\\\
Kigges der på systemet i sit store hele, så kommer det til at bestå af to sider til holdene, hvor holdenes kopper kommer til at stå. Der kommer til at være en møntindkastning, hvor der indkastes en mønt for at starte spillet. Efter en mønt er indkastet, så skal der dispenseres bolde, der skal anvendes til spillet. Der skal altså derfor være noget noget til opbevaring og dispensering af bolde.\\ 
\subsection{System Opdeling}
Efter at have opstillet systemet i sit store hele, kan det være smart at opdele systemet i delsystemer efter deres ansvarsområder. Her kan laves 2 delsystemer af henholdsvis, hver side af Beer Pong-bordet. At dele siderne op for sig selv er praktisk, da hver side kun skal bekymre sig om det, der sker på sin egen side. Der kan også laves et delsystem af det, der skal tage imod en mønt og dispensere en bold. Der vælges et samlet delsystem for møntindkast og dispensering, da de to dele hænger uløseligt sammen, og de fysiskset er placeret samme sted. Nu hvor der bestræbes efter høj samhørighed og lav kobling, så burde ingen af delsystemerne have ansvaret for at styre de andre og holde styr på de forskellige stadier i systemet. Derfor bør der også være et delsystem, der står for logikken og kontrollering af de andre delsystemer.\\
Da der er flere dele af systemet, der har unikke opgaver i forhold til de andre, så kan der her anvendes en separat CPU til hver del. Det vil altså sige, at der er en CPU til bolddispenseren, en CPU til hver spiller side og til sidst en CPU til styring af display og webserver. Dette valg sikrer at systemet er opdelt i relevante moduler, hvilket gør det nemmere at arbejde på, samt det gør det nemmere at udskifte eller lave ændringer på modulet uden det påvirker de andre. Det sikrer også den lave kobling mellem modulerne, da de bare skal videre kommunikere deres information til en controller, uden noget kendskab til de andre moduler.
\subsection{Spillersiderne som delsystemer}
Startes der med en analyse af det delsystemet omkring spillersiderne. Her skal der detekteres hvorvidt holdene fjerner, tilføjer eller rammer i en kop. Til dette skal der anvendes en form for sensor, der kan registrere alt dette. Når sådan et \textit{Game Event} registreres, så er det også vigtigt for en bruger at få visuel feedback på eventet. Denne feedback skal bestå af lys. Prisen for både sensor og lys spiller en væsentlig rolle, da der kommer til at være mange af dem, 6 steder på hver side af bordet. Det samme gør størrelsen på komponenterne, da kopperne skal stå rimelig tæt på hinanden.
Som CPU anvendes der en PSoC5 LP, der er et \textit{System On A Chip}, hvor der hører et udviklings IDE med, kaldet PSoC-creator. PSoC5 LP er smart til netop dette system, da der udvikles en prototype, og den er nem at eksperimentere og arbejde med, da den indeholder hardware komponenter på chippen(f.eks. timers, ADC osv). Desuden er det også et krav til systemet i forbindelse med 3. semesterprojektet\cite{}, at der anvendes en PSoC-platform.\\ PSoC-creator IDE'et gør det også nemt at udvikle på chippen, da der herigennem kan ændres på hardware på chippen og der dynamisk genereres API's til at anvende hardwaren. Derudover har IDE'et en gratis C-compiler, en editor og en debugger, der også kan anvendes på PSoC5 lp. Dette er især relevant, da der udvikles en prototype, men denne løsning er forholdsvis dyr. Hvis der derimod skulle laves et færdigt system, så skulle dette udviklingskit erstattes af en CPU i passende størrelse eller PSoC IC'en selv, samt de hardware komponenter, der blev anvendt på PSoC chippen.
\subsection{Bolddispenser som delsystem}
Bolddispenser- og møntindkast-systemet må have en aktuator, der styrer hvor mange bolde der dispenseres, da bolde skal flyttes fra systemet ud til brugeren. Derudover skal det også have en sensor til at detektere, hvorvidt der mangler bolde eller om dispenseren er fuld. En sensor skal også bruges til at detektere en mønt, da denne detektion er nødvendig for at starte spillet.\\
Som CPU for denne del anvendes PSoC5 lp ud fra de samme argumenter, som ved spillersiderne.
\subsection{System Controller som delsystem}
Det sidste delsystem er hjernen i systemet. Den skal kunne tilknyttes andre CPU'er og kommunikere med dem gennem en udspecificeret kommunikationsprotokol. Ud fra de funktionelle krav \ref{sec:funktionelle_krav} skal den også kunne hoste en WebServer og skrive status af systemet ud på et display.\\
Til dette anvendes der en RPi Zero W med indlejret Linux. Det er ideelt til netop denne opgave, da der kan laves drivere i forbindelse med kommunikation mellem processorene. Den har også HDMI til et display og  Wifi med de konfigurationer der skal til for, at den kan anvendes som en WebServer. Fra kravene 3. semesterprojekt\cite{} er der også givet, at der skal anvendes en indlejret linux-platform. 

\subsection{Kommunikation mellem delsystemer}


\end{document}